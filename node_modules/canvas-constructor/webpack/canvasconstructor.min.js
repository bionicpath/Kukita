!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CanvasConstructor=e():t.CanvasConstructor=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){t.exports={...r(1),Canvas:r(2)}},function(t,e){e.invert=t=>t.save().setGlobalCompositeOperation("difference").setColor("white").addRect(0,0,t.width,t.height).restore(),e.greyscale=t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4){const e=.2126*r[t]+.7152*r[t+1]+.0722*r[t+2];r[t]=e,r[t+1]=e,r[t+2]=e}return t.putImageData(e,0,0)},e.grayscale=e.greyscale,e.invertGrayscale=t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4){const e=255-(.2126*r[t]+.7152*r[t+1]+.0722*r[t+2]);r[t]=e,r[t+1]=e,r[t+2]=e}return t.putImageData(e,0,0)},e.invertGreyscale=e.invertGrayscale,e.sepia=t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4){const e=r[t],n=r[t+1],s=r[t+2];r[t]=.393*e+.769*n+.189*s,r[t+1]=.349*e+.686*n+.168*s,r[t+2]=.272*e+.534*n+.131*s}return t.putImageData(e,0,0)},e.silhouette=t=>{const e=t.getImageData(),{data:r}=e;for(let t=0;t<r.length;t+=4)r[t]=0,r[t+1]=0,r[t+2]=0;return t.putImageData(e,0,0)},e.threshold=(t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4){const r=.2126*n[t]+.7152*n[t+1]+.0722*n[t+2]>=e?255:0;n[t]=r,n[t+1]=r,n[t+2]=r}return t.putImageData(r,0,0)},e.invertedThreshold=(t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4){const r=.2126*n[t]+.7152*n[t+1]+.0722*n[t+2]>=e?0:255;n[t]=r,n[t+1]=r,n[t+2]=r}return t.putImageData(r,0,0)},e.brightness=(t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4)n[t]+=e,n[t+1]+=e,n[t+2]+=e;return t.putImageData(r,0,0)},e.darkness=(t,e)=>{const r=t.getImageData(),{data:n}=r;for(let t=0;t<n.length;t+=4)n[t]-=e,n[t+1]-=e,n[t+2]-=e;return t.putImageData(r,0,0)},e.myOldFriend=e.darkness,e.edge=t=>e.convolute(t,e.edgeLaPlaceMatrix,!0),e.edgeLaPlaceMatrix=[0,-1,0,-1,4,-1,0,-1,0],e.sharpen=(t,r=1)=>{for(let n=0;n<r;++n)e.convolute(t,e.sharpenLaPlaceMatrix,!0);return t},e.sharpenLaPlaceMatrix=[0,-1,0,-1,5,-1,0,-1,0],e.blur=(t,r=1)=>{for(let n=0;n<r;++n)e.convolute(t,e.blurLaPlaceMatrix,!0);return t},e.blurLaPlaceMatrix=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],e.convolute=(t,e,r=!0)=>{const n=Math.round(Math.sqrt(e.length)),s=Math.floor(n/2),a=t.getImageData(),i=a.data,o=a.width,h=a.height,c=o,u=h,l=t.getImageData(),d=l.data,f=r?1:0;for(let t=0;t<u;t++)for(let r=0;r<c;r++){const a=t,u=r,l=4*(t*c+r);let x=0,g=0,p=0,m=0;for(let t=0;t<n;t++)for(let r=0;r<n;r++){const c=a+t-s,l=u+r-s;if(c>=0&&c<h&&l>=0&&l<o){const s=4*(c*o+l),a=e[t*n+r];x+=i[s]*a,g+=i[s+1]*a,p+=i[s+2]*a,m+=i[s+3]*a}}d[l]=x,d[l+1]=g,d[l+2]=p,d[l+3]=m+f*(255-m)}return t.putImageData(l,0,0)}},function(t,e,r){const{browser:n,getFontHeight:s,InternalCanvas:a,textWrap:i}=r(3),o=n?()=>null:"function"==typeof a.createCanvas?a.createCanvas:(...t)=>new a(...t);class Canvas{constructor(...t){this.canvas=o(...t),this.context=this.canvas?this.canvas.getContext("2d"):null}get width(){return this.canvas.width}set width(t){this.canvas.width=t}get height(){return this.canvas.height}set height(t){this.canvas.height=t}get textFontHeight(){return s(this.context.font)}changeCanvasSize(t,e){return this.changeCanvasWidth(t).changeCanvasHeight(e)}changeCanvasWidth(t){return this.width=t,this}changeCanvasHeight(t){return this.height=t,this}save(){return this.context.save(),this}restore(){return this.context.restore(),this}rotate(...t){return this.context.rotate(...t),this}scale(...t){return this.context.scale(...t),this}translate(...t){return this.context.translate(...t),this}clip(...t){return this.context.clip(...t),this}setTransform(...t){return this.context.setTransform(...t),this}resetTransformation(){return this.setTransform(1,0,0,1,0,0)}getImageData(t=0,e=0,r=this.width,n=this.height,s){if("function"==typeof t&&(s=t,t=0),s){if("function"!=typeof s)throw new TypeError("Callback must be a function");return s.call(this,this.context.getImageData(t,e,r,n),this),this}return this.context.getImageData(t,e,r,n)}putImageData(...t){return this.context.putImageData(...t),this}fill(...t){return this.context.fill(...t),this}addText(...t){return this.context.fillText(...t),this}addResponsiveText(t,e,r,n){const[,s="",a,i]=/(\w+ )?(\d+)(.+)/.exec(this.context.font),o=parseInt(a,10),{width:h}=this.measureText(t),c=n>h?o:n/h*o;return this.setTextFont(`${s}${c}${i}`).addText(t,e,r)}addMultilineText(t,e,r){const n=t.split(/\r?\n/);if(n.length<=1)return this.addText(t,e,r);const s=this.textFontHeight;let a=r;for(const t of n)this.addText(t,e,Math.floor(a)),a+=s;return this}addWrappedText(t,e,r,n){const s=i(this,t,n);return this.addMultilineText(s,e,r)}stroke(...t){return this.context.stroke(...t),this}addStrokeRect(...t){return this.context.strokeRect(...t),this}addStrokeText(...t){return this.context.strokeText(...t),this}measureText(t,e){if(e){if("function"!=typeof e)throw new TypeError("Callback must be a function.");return e.call(this,this.context.measureText(t),this),this}return this.context.measureText(t)}setTextSize(t){const[,e="",r]=/(\w+ )?(?:\d+)(.+)/.exec(this.context.font);return this.setTextFont(`${e}${t}${r}`)}setStroke(t="#000000"){return this.context.strokeStyle=t,this}setLineWidth(t=1){return this.context.lineWidth=t,this}setStrokeWidth(t){return this.setLineWidth(t)}setLineDashOffset(t){return this.context.lineDashOffset=t,this}setLineJoin(t){return this.context.lineJoin=t,this}setLineCap(t){return this.context.lineCap=t,this}setLineDash(...t){return this.context.setLineDash(...t),this}addImage(t,...e){const r=e.length%2?e.pop():{};if(r.restore&&this.save(),r.type){isNaN(r.radius)&&(r.radius=10);const[t,n,s,a]=e;"round"===r.type?this.createRoundClip(t+r.radius,n+r.radius,r.radius):"bevel"===r.type&&this.createBeveledClip(t,n,s,a,r.radius)}return this._resolveImage(t,t=>this.context.drawImage(t,...e)),r.restore&&this.restore(),this}addRoundImage(t,e,r,n,s,a,i){return"boolean"==typeof a&&([a=Math.min(n,s)/2,i]=[i,a]),void 0===i&&(i=!0),this.addImage(t,e,r,n,s,{type:"round",radius:a,restore:i})}addCircularImage(t,e,r,n,s=!0){s&&this.save();const a=2*n;return this.createRoundClip(e,r,n),this._resolveImage(t,t=>this.context.drawImage(t,e-n,r-n,a,a)),s&&this.restore(),this}addBeveledImage(t,e,r,n,s,a=10,i=!0){return this.addImage(t,e,r,n,s,{type:"bevel",radius:a,restore:i})}addCircle(t,e,r){return this.save().createRoundPath(t,e,r).fill().restore()}addRect(...t){return this.context.fillRect(...t),this}addBeveledRect(...t){return this.save().createBeveledPath(...t).fill().restore()}createRoundPath(t,e,r,n=0,s=2*Math.PI){return this.context.beginPath(),this.context.arc(t,e,r,n,s,!1),this}createRoundClip(...t){return this.createRoundPath(...t).clip()}createRectPath(...t){return this.context.rect(...t),this}createRectClip(...t){return this.createRectPath(...t).clip()}createBeveledPath(t,e,r,n,s=10){if(r>0&&n>0){let a;"number"==typeof s?a={tl:s=Math.min(s,r/2,n/2),tr:s,br:s,bl:s}:(a=s,s=Math.min(5,r/2,n/2));const{tl:i=s,tr:o=s,br:h=s,bl:c=s}=a;this.context.beginPath(),this.context.moveTo(t+i,e),this.context.lineTo(t+r-o,e),this.context.quadraticCurveTo(t+r,e,t+r,e+o),this.context.lineTo(t+r,e+n-h),this.context.quadraticCurveTo(t+r,e+n,t+r-h,e+n),this.context.lineTo(t+c,e+n),this.context.quadraticCurveTo(t,e+n,t,e+n-c),this.context.lineTo(t,e+i),this.context.quadraticCurveTo(t,e,t+i,e),this.context.closePath(),this.context.clip()}return this}createBeveledClip(...t){return this.createBeveledPath(...t).clip()}setColor(t){return this.context.fillStyle=t,this}setTextFont(t){return this.context.font=t,this}setTextAlign(t){return this.context.textAlign=t,this}setTextBaseline(t){return this.context.textBaseline=t,this}beginPath(){return this.context.beginPath(),this}closePath(){return this.context.closePath(),this}createPattern(t,e,r){return this._resolveImage(t,t=>r(this.context.createPattern(t,e))),this}printPattern(t,e){return this.createPattern(t,e,t=>this.setColor(t))}createLinearGradient(t,e,r,n,s=[]){const a=this.context.createLinearGradient(t,e,r,n);for(const t of s)a.addColorStop(t.position,t.color);return a}printLinearGradient(...t){const e=this.createLinearGradient(...t);return this.setColor(e)}createRadialGradient(t,e,r,n,s,a,i=[]){const o=this.context.createRadialGradient(t,e,r,n,s,a);for(const t of i)o.addColorStop(t.position,t.color);return o}printRadialGradient(...t){const e=this.createRadialGradient(...t);return this.setColor(e)}createEllipse(t,e,r,n,s=0,a=0,i=2*Math.PI,o){return this.context.ellipse(t,e,r,n,s,a,i,o),this}arc(t,e,r,n=0,s=2*Math.PI,a=!1){return this.context.arc(t,e,r,n,s,a),this}arcTo(...t){return this.context.arcTo(...t),this}quadraticCurveTo(...t){return this.context.quadraticCurveTo(...t),this}bezierCurveTo(...t){return this.context.bezierCurveTo(...t),this}lineTo(...t){return this.context.lineTo(...t),this}moveTo(...t){return this.context.moveTo(...t),this}setShadowBlur(t){return this.context.shadowBlur=t,this}setShadowColor(t){return this.context.shadowColor=t,this}setShadowOffsetX(t){return this.context.shadowOffsetX=t,this}setShadowOffsetY(t){return this.context.shadowOffsetY=t,this}setMiterLimit(t){return this.context.miterLimit=t,this}setPatternQuality(t){return this.context.patternQuality=t,this}setTextDrawingMode(t){return this.context.textDrawingMode=t,this}setAntialiasing(t){return this.context.antialias=t,this}setGlobalCompositeOperation(t){return this.context.globalCompositeOperation=t,this}setGlobalAlpha(t){return this.context.globalAlpha=t,this}resetShadows(){return this.setShadowBlur(0).setShadowOffsetX(0).setShadowOffsetY(0).setShadowColor("transparent")}clearCircle(t,e,r,n=0,s=2*Math.PI){return this.createRoundClip(t,e,r,n,s).clearPixels(t-r,e-r,2*r,2*r)}clearPixels(t=0,e=0,r=this.width,n=this.height){return this.context.clearRect(t,e,r,n),this}getLineDash(){return this.context.getLineDash()}get lineDash(){return this.getLineDash()}isPointInPath(...t){return this.context.isPointInPath(...t)}isPointInStroke(...t){return this.context.isPointInStroke(...t)}process(t,...e){return t.call(this,this,...e),this}addTextFont(t,e){return"function"==typeof this.context.addFont?this.context.addFont(new a.Font(e,t)):Canvas.registerFont(t,e),this}toBuffer(...t){return this.canvas.toBuffer(...t)}toBufferAsync(){return new Promise((t,e)=>this.canvas.toBuffer((r,n)=>{r?e(r):t(n)}))}toDataURL(...t){return this.canvas.toDataURL(...t)}toDataURLAsync(t){return new Promise((e,r)=>this.canvas.toDataURL(t,(t,n)=>{t?r(t):e(n)}))}toBlob(...t){return this.canvas.toBlob(...t)}toBlobAsync(...t){return new Promise(e=>this.canvas.toBlob(e,...t))}wrapText(t,e,r){const n=i(this,t,e);if(r){if("function"!=typeof r)throw new TypeError("Callback must be a function");return r.call(this,n,this),this}return n}_resolveImage(t,e){if(t instanceof a.Image)return e(t),t;const r=new a.Image;return r.onload=e.bind(this,r),r.src=t,r}static from(t){const e=new Canvas;e.canvas=t,e.context=t.getContext("2d")}static get internalCanvas(){return a}static registerFont(t,e){if("function"!=typeof a.registerFont)throw new Error("registerFont is not supported in this version of node-canvas, please install node-canvas 2.x.");if(!e)throw new TypeError("A family must be specified for registerFont.");return a.registerFont(t,e.constructor===Object?e:{family:e}),Canvas}}t.exports=Canvas},function(t,e,r){e.browser="undefined"!=typeof window,e.InternalCanvas=(()=>{if(e.browser)return"undefined"==typeof HTMLCanvasElement?null:HTMLCanvasElement;try{return r(4)}catch(t){return r(5)}})(),e.getFontHeight=(()=>{if(!e.browser&&"parseFont"in e.InternalCanvas)return t=>e.InternalCanvas.parseFont(t).size;const t=/([\d.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q)/i,r=new Map;return e=>{const n=r.get(e);if(n)return n;const s=t.exec(e);if(!s)return null;let a=Number(s[1]);switch(s[2]){case"pt":a/=.75;break;case"pc":a*=16;break;case"in":a*=96;break;case"cm":a*=96/2.54;break;case"mm":a*=96/25.4;break;case"em":case"rem":a*=16/.75;break;case"q":a*=96/25.4/4}return r.set(e,a),a}})(),e.textWrap=(t,e,r)=>{const n=[],s=[],a=t.context.measureText(" ").width;for(const i of e.split(/\r?\n/)){let e=r;for(const o of i.split(" ")){const i=t.context.measureText(o).width,h=i+a;h>e?(s.length&&(n.push(s.join(" ")),s.length=0),s.push(o),e=r-i):(e-=h,s.push(o))}s.length&&(n.push(s.join(" ")),s.length=0)}return n.join("\n")}},function(t,e){},function(t,e){}])}));